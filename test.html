
    @ApiOperation(value = "Sync Investran FX Rate by Date")
    @RequestMapping(value = "/qrepricing/data-prep/fx-rate/{InputDate}/{RunId}", method = RequestMethod.GET)
    ResponseEntity <List<String>> syncItrnFXRateByDate(
            HttpServletRequest request, @PathVariable String InputDate, @PathVariable String RunId) {
        String report = "FX Spot Rates";
        String parameters = String.format(
        "",
        InputDate, InputDate);
        List<String> results = call_rome(report, parameters);
        Timestamp now = new Timestamp(System.currentTimeMillis());

        HashMap<Integer, FSC_Repricing_FX_Rate> dict = new HashMap<Integer, FSC_Repricing_FX_Rate>();

        boolean header = true;
        String currencyDate = null;
        String currencyISO = null;
        BigDecimal currencyRate = null;
        int i = 0;

        FSC_Valuation_Quarters valuationQuarter = fscValuationQuartersRepository.findByActive(true).get(0);
        String vdate = valuationQuarter.getCurrentQuarterEndDate().toString();
        logger.info("Valuation Date: " + vdate);
        logger.info(String.valueOf(results == null));
        if (results != null) {
            for (String line : results) {
                String[] items = line.split("\\|");
                logger.info(String.valueOf(items.length));
                if (header)
                    header = false;
                else if (String.valueOf(items.length).equals("3")) {

                    int positionID = (i);
                    if (currencyDate == null)
                        currencyDate = items[0];
                        logger.info(currencyDate);
                    if (currencyISO == null)
                        currencyISO = items[1];
                        logger.info(currencyISO);
                    if (currencyRate == null)
                        currencyRate = new BigDecimal(items[2]);
                        logger.info(currencyRate.toString());

                    FSC_Repricing_FX_Rate r;
                    RepricingFxId p;
                    if (dict.containsKey(positionID))
                        r = dict.get(positionID);
                    else {
                        r = new FSC_Repricing_FX_Rate();
                        p = new RepricingFxId();
                        r.setID(p);
                        r.setCurrencyRate(currencyRate);
                        p.setValuationDate(vdate);
                        p.setCurrencyDate(currencyDate);
                        p.setCurrencyISO(currencyISO);

                        dict.put(positionID, r);
                        i++;
                        currencyDate = null;
                        currencyISO = null;
                        currencyRate = null;

                    }
                }

            }

        }
    List<FSC_Repricing_FX_Rate> list = new ArrayList<>();
    for (FSC_Repricing_FX_Rate r : dict.values())
        list.add(r);
    if (list.size() > 0)
        FSC_Repricing_FX_RateRepository.save(list);
    List<String> SuccessList = new ArrayList<String>();
    SuccessList.add("");
    return new ResponseEntity<List<String>>(SuccessList, HttpStatus.OK);
    }

