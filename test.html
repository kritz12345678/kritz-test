import {Component, EventEmitter, Input, Output} from '@angular/core';
import * as Highcharts from 'highcharts';
import {HighchartsChartModule} from "highcharts-angular";
import {ChartServiceService} from "../chart-service.service";

@Component({
  selector: 'app-base-chart',
  templateUrl: './base-chart.component.html',
  styleUrls: ['./base-chart.component.css']
})
export class BaseChartComponent {

  Highcharts: typeof Highcharts = Highcharts;
  @Input() clickevent:Boolean = true
  @Input() chartOptions?: Highcharts.Options ;
  @Input() chartId!: string;
   @Output() chartSeriesClick: EventEmitter<{ seriesName: string; category: string }>=new EventEmitter();
  @Output() ready:EventEmitter<void>= new EventEmitter<void>()

  constructor(private  chartService: ChartServiceService) {}

  ngOnInit(): void {
    console.log("ddd", this.chartId)
    if (this.chartOptions) {
      const chartInstance = Highcharts.chart(this.chartId, this.chartOptions);
      this.chartService.setchartInstances(this.chartId, chartInstance);
      if (this.clickevent)
        this.chartService.setclickfunction(chartInstance,this.chartSeriesClick);
    } else {
      console.error('ChartOptionsis undefined');
    }
    this.ready.emit();

  }
}
